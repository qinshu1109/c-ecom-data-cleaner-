# 代码风格规范

## 1. 格式化规则

### 1.1 基本配置
- 使用 `pyproject.toml` 中的 `ruff` + `black` 配置
- 行宽限制为 100 字符
- 使用 f-string 进行字符串格式化
- 禁止使用 print 语句，改用 logging 模块

### 1.2 代码组织
- 导入语句按标准库、第三方库、本地模块顺序排列
- 类定义前后空两行
- 函数定义前后空一行
- 相关函数放在一起

## 2. 异常处理规范

### 2.1 异常捕获
- 必须显式捕获具体异常类型
- 禁止使用裸异常 `except:`
- 异常信息必须明确且可追踪
- 使用 `try-except-finally` 结构

### 2.2 日志记录
- 使用 logging 模块记录异常
- 设置合适的日志级别
- 包含足够的上下文信息
- 避免敏感信息泄露

## 3. 命名规范

### 3.1 变量命名
- 使用有意义的变量名
- 遵循 Python 命名约定
- 避免使用单字母变量名
- 常量使用大写字母

### 3.2 函数命名
- 使用动词开头
- 清晰表达功能
- 避免缩写
- 保持一致性

## 4. 注释规范

### 4.1 文档字符串
- 使用 numpy-docstring 风格
- 包含参数说明
- 包含返回值类型
- 包含示例代码（如需要）

### 4.2 代码注释
- 解释复杂逻辑
- 说明算法步骤
- 标注 TODO 和 FIXME
- 保持注释更新

## 5. 类型提示

### 5.1 基本类型
- 使用 typing 模块
- 为所有参数添加类型
- 为返回值添加类型
- 使用 Optional 表示可选参数

### 5.2 复杂类型
- 使用 TypeVar 定义泛型
- 使用 Generic 定义泛型类
- 使用 Union 表示联合类型
- 使用 Literal 表示字面量类型

## 6. 代码质量

### 6.1 代码复杂度
- 控制函数长度
- 控制嵌套层级
- 避免重复代码
- 使用设计模式

### 6.2 性能考虑
- 避免不必要的循环
- 使用生成器
- 优化数据结构
- 注意内存使用

## 7. 测试规范

### 7.1 单元测试
- 使用 pytest 框架
- 测试文件命名规范
- 测试函数命名规范
- 使用 fixture

### 7.2 测试覆盖
- 测试正常情况
- 测试边界条件
- 测试异常情况
- 测试性能要求 